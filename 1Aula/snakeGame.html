<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            let canvas = document.querySelector("canvas").getContext("2d");

            /*canvas.fillStyle = "#f00";
            canvas.fillRect(40, 40, 50, 50);*/
            const size = 30;

            const snake = [
                {
                    x: 300,
                    y: 300,
                }
            ]
            let direction, loopId

            function drawSnake() {
                canvas.fillStyle = "#ddd";

                snake.forEach((position, index) => {

                    if (index == snake.length - 1) {
                        canvas.fillStyle = "#fff";
                    }
                    canvas.fillRect(position.x, position.y, size, size);

                });

            }

            function moveSnake() {

                if (!direction) return;
                const head = snake[snake.length - 1];

                if (direction == "right") {
                    snake.push(
                        {
                            x: head.x + size,
                            y: head.y,
                        }
                    )
                }
                if (direction == "left") {
                    snake.push(
                        {
                            x: head.x - size,
                            y: head.y,
                        }
                    )
                }
                if (direction == "up") {
                    snake.push(
                        {
                            x: head.x,
                            y: head.y - size,
                        }
                    )
                }
                if (direction == "down") {
                    snake.push(
                        {
                            x: head.x,
                            y: head.y + size,
                        }
                    )
                }
                snake.shift()
            }


            function drawGrid() {
                canvas.lineWidth = 1;
                canvas.strokeStyle = "#383737";

                for (let i = 30; i < 600; i += 30) {
                    canvas.beginPath();
                    canvas.lineTo(i, 0);
                    canvas.lineTo(i, 600);
                    canvas.stroke();
                }
                for (let i = 30; i < 600; i += 30) {
                    canvas.beginPath();
                    canvas.moveTo(0, i);
                    canvas.lineTo(600, i);
                    canvas.stroke();
                }
            } console.log(drawGrid)
            drawGrid();

            function gameLoop() {
                clearInterval(loopId)
                canvas.clearRect(0, 0, 600, 600)

                drawGrid();
                moveSnake();
                drawSnake();

                loopId = setTimeout(() => {
                    gameLoop();
                }, 300)
            }
            gameLoop();

            document.addEventListener("keydown", ({ key }) => {
                if (key == "ArrowRight" && direction != "left") {
                    direction = "right"
                }
                if (key == "ArrowLeft" && direction != "right") {
                    direction = "left"
                }
                if (key == "ArrowUp" && direction != "down") {
                    direction = "up"
                }
                if (key == "ArrowDown" && direction != "up") {
                    direction = "down"
                }
                console.log(event.key)
            })

        })
    </script>
    <style>
        canvas {
            border: solid 1px #000;
            background-color: #232323;
        }
    </style>
</head>

<body>
    <canvas width="600" height="600"></canvas>

</body>

</html>